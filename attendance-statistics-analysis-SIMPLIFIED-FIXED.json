{
  "name": "å‡ºå‹¤çµ±è¨ˆåˆ†æ-å„ªåŒ–å®Œæ•´ç‰ˆ-ç°¡åŒ–ç‰ˆ",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "id": "2d5a4c13-eece-48e6-9597-86083e23a9ce",
      "name": "æ¯å°æ™‚åŸ·è¡Œ1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        -992,
        352
      ]
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// å‡ºç¼ºå‹¤è§£æç¨‹å¼ç¢¼ - ä¿®å¾©ç‰ˆ (æ”¯æ´å¤šæ—¥æœŸæ ¼å¼)\n// è‡ªå‹•å¾ Slack è¨Šæ¯ä¸­æå–ä½¿ç”¨è€…è³‡è¨Š\n// ä¿®å¾©: 1) æ—¥æœŸéå¢bug 2) æ”¯æ´é€—è™Ÿåˆ†éš”çš„å¤šæ—¥æœŸ\n// ========================================\n\nconst messages = $input.all();\nconst attendanceData = [];\nconst taipeiTimeZone = 'Asia/Taipei';\n\n// è‡ªå‹•å»ºç«‹çš„ä½¿ç”¨è€…å°ç…§è¡¨\nconst autoUserMapping = {};\n\n// æƒææ‰€æœ‰è¨Šæ¯ï¼Œå»ºç«‹ä½¿ç”¨è€…å°ç…§è¡¨\nfor (const item of messages) {\n  const message = item.json;\n\n  if (message.user && message.user_profile) {\n    const userId = message.user;\n    const profile = message.user_profile;\n    const userName = profile.real_name || profile.display_name || profile.name || userId;\n\n    if (userName && userName !== userId) {\n      autoUserMapping[userId] = userName;\n    }\n  }\n}\n\n// åç¨±åˆ¥åå°ç…§è¡¨\nconst nameAliases = {\n  \"bread\": \"RD-Bread\",\n  \"mark\": \"PM-Mark\",\n  \"mike\": \"Math-Mike Tsai\"\n};\n\n// å®šç¾©ç‹€æ…‹é—œéµå­—\nconst statusKeywords = {\n  'remote': 'é ç«¯å·¥ä½œ',\n  'wfh': 'åœ¨å®¶å·¥ä½œ',\n  'work from home': 'åœ¨å®¶å·¥ä½œ',\n  'è«‹å‡': 'è«‹å‡',\n  'ç—…å‡': 'ç—…å‡',\n  'äº‹å‡': 'äº‹å‡',\n  'ç‰¹ä¼‘': 'ç‰¹ä¼‘',\n  'å¹´å‡': 'å¹´å‡',\n  'ç”Ÿæ—¥å‡': 'ç”Ÿæ—¥å‡',\n  'birthday': 'ç”Ÿæ—¥å‡',\n  'bdå‡': 'ç”Ÿæ—¥å‡',\n  'bd': 'ç”Ÿæ—¥å‡',\n  'å‡ºå·®': 'å‡ºå·®',\n  'å…¬å‡º': 'å…¬å‡º',\n  'åŠå¤©': 'è«‹å‡åŠå¤©',\n  'ä¸Šåˆè«‹å‡': 'ä¸Šåˆè«‹å‡',\n  'ä¸‹åˆè«‹å‡': 'ä¸‹åˆè«‹å‡',\n  'æ—©é€€': 'æ—©é€€',\n  'é²åˆ°': 'é²åˆ°',\n  'å¤–å‡º': 'å¤–å‡º',\n  'å¥æª¢': 'å¥æª¢',\n  'å©šå‡': 'å©šå‡',\n  'å–ªå‡': 'å–ªå‡',\n  'ç”¢å‡': 'ç”¢å‡',\n  'é™ªç”¢å‡': 'é™ªç”¢å‡',\n  'è‚²å¬°å‡': 'è‚²å¬°å‡',\n  'å®¶åº­ç…§é¡§å‡': 'å®¶åº­ç…§é¡§å‡',\n  'å…¬å‡': 'å…¬å‡',\n  'è£œä¼‘': 'è£œä¼‘',\n  'èª¿ä¼‘': 'èª¿ä¼‘',\n  'ç”Ÿç†å‡': 'ç”Ÿç†å‡'\n};\n\n// å–å¾—ä½¿ç”¨è€…é¡¯ç¤ºåç¨±\nfunction getUserDisplayName(userId) {\n  return autoUserMapping[userId] || userId;\n}\n\n// æ›¿æ›è¨Šæ¯ä¸­çš„ä½¿ç”¨è€… ID ç‚ºå¯¦éš›å§“å\nfunction replaceUserIdsWithNames(text) {\n  let replacedText = text;\n  const userIdPattern = /<@([A-Z0-9]+)>/g;\n  replacedText = replacedText.replace(userIdPattern, (match, userId) => {\n    const userName = getUserDisplayName(userId);\n    return `@${userName}`;\n  });\n  const namePattern = /<@([^>]+)>/g;\n  replacedText = replacedText.replace(namePattern, (match, name) => {\n    if (!/^U[A-Z0-9]+$/.test(name)) {\n      return `@${name}`;\n    }\n    return match;\n  });\n  return replacedText;\n}\n\n// è§£æè¨Šæ¯ç‹€æ…‹\nfunction parseMessageStatus(messageText) {\n  let cleanText = messageText.replace(/[ï¼ˆ(][^ï¼‰)]*[ï¼‰)]/g, '').trim();\n  const textLower = cleanText.toLowerCase();\n\n  for (const [keyword, statusName] of Object.entries(statusKeywords)) {\n    if (keyword.length <= 3) {\n      const escapedKeyword = keyword.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n      const regexPattern = '\\\\b' + escapedKeyword + '\\\\b';\n      const regex = new RegExp(regexPattern, 'i');\n      if (regex.test(cleanText)) {\n        return statusName;\n      }\n    } else {\n      if (textLower.includes(keyword)) {\n        return statusName;\n      }\n    }\n  }\n\n  return 'æ­£å¸¸ä¸Šç­';\n}\n\n// å¾è¨Šæ¯æ–‡å­—ä¸­æå–å¯¦éš›è«‹å‡çš„ä½¿ç”¨è€…\nfunction extractActualUser(messageText) {\n  // æª¢æŸ¥ç‰¹æ®Šæ ¼å¼ \"æ—¥æœŸ åç¨± ç‹€æ…‹\"\n  const specialPattern = /^\\d{1,2}\\/\\d{1,2}\\s+([a-zA-Z]+)\\s+/i;\n  const specialMatch = messageText.match(specialPattern);\n\n  if (specialMatch) {\n    const nameFound = specialMatch[1].toLowerCase();\n\n    if (nameAliases[nameFound]) {\n      return { userId: null, userName: nameAliases[nameFound] };\n    }\n\n    for (const [userId, fullName] of Object.entries(autoUserMapping)) {\n      if (fullName.toLowerCase().includes(nameFound)) {\n        return { userId: userId, userName: fullName };\n      }\n    }\n\n    const capitalizedName = nameFound.charAt(0).toUpperCase() + nameFound.slice(1);\n    return { userId: null, userName: capitalizedName };\n  }\n\n  // æ¨¡å¼1: <@UserID> æ ¼å¼\n  const pattern1 = /<@(U[A-Z0-9]+)>/;\n  const match1 = messageText.match(pattern1);\n\n  if (match1) {\n    const userId = match1[1];\n    return { userId: userId, userName: getUserDisplayName(userId) };\n  }\n\n  // æ¨¡å¼2: <@ä½¿ç”¨è€…åç¨±> æ ¼å¼\n  const pattern2 = /<@([^>]+)>/;\n  const match2 = messageText.match(pattern2);\n\n  if (match2) {\n    const name = match2[1];\n    if (!/^U[A-Z0-9]+$/.test(name)) {\n      return { userId: null, userName: name };\n    }\n  }\n\n  // æ¨¡å¼3: @ä½¿ç”¨è€…åç¨± æ ¼å¼\n  const pattern3 = /@([^\\s>]+)/;\n  const match3 = messageText.match(pattern3);\n\n  if (match3) {\n    const name = match3[1];\n    return { userId: null, userName: name };\n  }\n\n  return null;\n}\n\n// âœ… ä¿®å¾©: æ”¯æ´é€—è™Ÿåˆ†éš”çš„å¤šå€‹æ—¥æœŸ/æ—¥æœŸç¯„åœ\nfunction extractLeaveDates(messageText, messageTimestamp) {\n  const currentYear = new Date().getFullYear();\n  const results = [];\n\n  // âœ… æ–°å¢: å…ˆè™•ç†é€—è™Ÿåˆ†éš”çš„å¤šå€‹æ—¥æœŸæ®µ\n  // ä¾‹å¦‚: \"10/23ï¼Œ27-31\" æˆ– \"10/23, 10/27-31\"\n  const commaParts = messageText.split(/[,ï¼Œã€]/);\n\n  if (commaParts.length > 1) {\n    // æœ‰é€—è™Ÿåˆ†éš”ï¼Œåˆ†åˆ¥è™•ç†æ¯å€‹éƒ¨åˆ†\n    for (const part of commaParts) {\n      const partResults = extractSingleDateRange(part.trim(), messageTimestamp, currentYear);\n      results.push(...partResults);\n    }\n\n    if (results.length > 0) {\n      return results;\n    }\n  }\n\n  // æ²’æœ‰é€—è™Ÿæˆ–é€—è™Ÿè™•ç†å¤±æ•—ï¼Œä½¿ç”¨åŸæœ¬çš„é‚è¼¯\n  return extractSingleDateRange(messageText, messageTimestamp, currentYear);\n}\n\n// âœ… æ–°å¢: æå–å–®ä¸€æ—¥æœŸæˆ–æ—¥æœŸç¯„åœçš„è¼”åŠ©å‡½æ•¸\nfunction extractSingleDateRange(messageText, messageTimestamp, currentYear) {\n  const results = [];\n\n  // æª¢æŸ¥æ—¥æœŸç¯„åœæ ¼å¼\n  const rangePatterns = [\n    /(\\d{1,2})\\/(\\d{1,2})\\s*[~ï½\\-]\\s*(\\d{1,2})\\/(\\d{1,2})/,\n    /(\\d{1,2})\\/(\\d{1,2})\\s*[~ï½\\-]\\s*(\\d{1,2})(?!\\/)/,\n  ];\n\n  for (const pattern of rangePatterns) {\n    const match = messageText.match(pattern);\n    if (match) {\n      let startMonth, startDay, endMonth, endDay;\n\n      if (match.length === 5) {\n        startMonth = parseInt(match[1]);\n        startDay = parseInt(match[2]);\n        endMonth = parseInt(match[3]);\n        endDay = parseInt(match[4]);\n      } else if (match.length === 4) {\n        startMonth = parseInt(match[1]);\n        startDay = parseInt(match[2]);\n        endMonth = startMonth;\n        endDay = parseInt(match[3]);\n      }\n\n      if (startMonth >= 1 && startMonth <= 12 && startDay >= 1 && startDay <= 31 &&\n          endMonth >= 1 && endMonth <= 12 && endDay >= 1 && endDay <= 31) {\n\n        const startDate = new Date(currentYear, startMonth - 1, startDay);\n        const endDate = new Date(currentYear, endMonth - 1, endDay);\n\n        if (endDate < startDate) {\n          endDate.setFullYear(currentYear + 1);\n        }\n\n        const messageDate = new Date(messageTimestamp);\n        const daysDiff = (messageDate - startDate) / (1000 * 60 * 60 * 24);\n\n        if (daysDiff > 0 && daysDiff < 60 && messageDate.getMonth() > startMonth - 1) {\n          startDate.setFullYear(currentYear - 1);\n          endDate.setFullYear(currentYear - 1);\n        } else if (daysDiff > 180) {\n          startDate.setFullYear(currentYear + 1);\n          endDate.setFullYear(currentYear + 1);\n        } else if (daysDiff < -180) {\n          startDate.setFullYear(currentYear - 1);\n          endDate.setFullYear(currentYear - 1);\n        }\n\n        const currentDate = new Date(startDate);\n        while (currentDate <= endDate) {\n          const dayOfWeek = currentDate.getDay();\n          if (dayOfWeek !== 0 && dayOfWeek !== 6) {\n            results.push({\n              date: currentDate.toLocaleDateString('zh-TW', {\n                timeZone: taipeiTimeZone,\n                year: 'numeric',\n                month: '2-digit',\n                day: '2-digit'\n              }),\n              status: null\n            });\n          }\n          // âœ… ä¿®å¾©: æ­£ç¢ºçš„æ—¥æœŸéå¢\n          currentDate.setDate(currentDate.getDate() + 1);\n        }\n\n        return results;\n      }\n    }\n  }\n\n  // æª¢æŸ¥å–®ä¸€æ—¥æœŸ\n  const singlePatterns = [\n    /(\\d{1,2})\\/(\\d{1,2})/,\n    /(\\d{1,2})æœˆ(\\d{1,2})æ—¥?/,\n  ];\n\n  for (const pattern of singlePatterns) {\n    const match = messageText.match(pattern);\n    if (match) {\n      const month = parseInt(match[1]);\n      const day = parseInt(match[2]);\n\n      if (month >= 1 && month <= 12 && day >= 1 && day <= 31) {\n        const leaveDate = new Date(currentYear, month - 1, day);\n\n        const dayOfWeek = leaveDate.getDay();\n        if (dayOfWeek === 0 || dayOfWeek === 6) {\n          return results;\n        }\n\n        const messageDate = new Date(messageTimestamp);\n        const daysDiff = (messageDate - leaveDate) / (1000 * 60 * 60 * 24);\n        if (daysDiff > 180) {\n          leaveDate.setFullYear(currentYear + 1);\n        } else if (daysDiff < -180) {\n          leaveDate.setFullYear(currentYear - 1);\n        }\n\n        results.push({\n          date: leaveDate.toLocaleDateString('zh-TW', {\n            timeZone: taipeiTimeZone,\n            year: 'numeric',\n            month: '2-digit',\n            day: '2-digit'\n          }),\n          status: null\n        });\n        return results;\n      }\n    }\n  }\n\n  // é è¨­è¿”å›è¨Šæ¯ç™¼é€æ—¥æœŸ\n  const defaultDate = new Date(messageTimestamp);\n  const dayOfWeek = defaultDate.getDay();\n\n  if (dayOfWeek !== 0 && dayOfWeek !== 6) {\n    results.push({\n      date: defaultDate.toLocaleDateString('zh-TW', {\n        timeZone: taipeiTimeZone,\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      }),\n      status: null\n    });\n  }\n\n  return results;\n}\n\n// ä¸»è¦è™•ç†é‚è¼¯\nfor (const item of messages) {\n  const message = item.json;\n  if (!message.text) continue;\n\n  // éæ¿¾ç³»çµ±è¨Šæ¯\n  const systemMessagePatterns = [\n    /å·²åŠ å…¥é »é“/,\n    /å·²é›¢é–‹é »é“/,\n    /åŠ å…¥äº† #/,\n    /set the channel/,\n    /renamed the channel/,\n    /uploaded a file/,\n    /^slackbot$/i\n  ];\n\n  const isSystemMessage = systemMessagePatterns.some(pattern =>\n    pattern.test(message.text)\n  );\n\n  if (isSystemMessage) {\n    continue;\n  }\n\n  const messageTimestamp = parseFloat(message.ts) * 1000;\n  const messageTime = new Date(messageTimestamp);\n\n  const userInfo = extractActualUser(message.text);\n  if (!userInfo) continue;\n\n  let userName = userInfo.userName || 'Unknown';\n  const actualLeaveDates = extractLeaveDates(message.text, messageTimestamp);\n  const status = parseMessageStatus(message.text);\n\n  const timeStr = messageTime.toLocaleTimeString('zh-TW', {\n    timeZone: taipeiTimeZone,\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false\n  });\n\n  for (const leaveInfo of actualLeaveDates) {\n    attendanceData.push({\n      date: leaveInfo.date,\n      messageDate: messageTime.toLocaleDateString('zh-TW', {\n        timeZone: taipeiTimeZone,\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      }),\n      time: timeStr,\n      userName: userName,\n      userId: userInfo.userId || null,\n      status: status,\n      details: replaceUserIdsWithNames(message.text)\n    });\n  }\n}\n\n// æŒ‰æ—¥æœŸå’Œä½¿ç”¨è€…åˆ†çµ„çµ±è¨ˆ\nconst userStats = {};\nfor (const record of attendanceData) {\n  const key = `${record.userName}_${record.date}`;\n  if (!userStats[key]) {\n    userStats[key] = {\n      userName: record.userName,\n      userId: record.userId,\n      date: record.date,\n      messageDate: record.messageDate,\n      firstCheckIn: record.time,\n      lastCheckOut: record.time,\n      status: record.status,\n      details: record.details,\n      messageCount: 1\n    };\n  } else {\n    userStats[key].lastCheckOut = record.time;\n    userStats[key].messageCount++;\n    if (record.status !== 'æ­£å¸¸ä¸Šç­') {\n      userStats[key].status = record.status;\n      userStats[key].details = record.details;\n    }\n  }\n}\n\n// æ•´ç†æœ€çµ‚çµæœ\nconst finalResults = Object.values(userStats).map(stat => {\n  let workDuration = '';\n  if (stat.firstCheckIn !== stat.lastCheckOut) {\n    const [startHour, startMin] = stat.firstCheckIn.split(':').map(Number);\n    const [endHour, endMin] = stat.lastCheckOut.split(':').map(Number);\n    const durationMinutes = (endHour * 60 + endMin) - (startHour * 60 + startMin);\n    if (durationMinutes > 0) {\n      const hours = Math.floor(durationMinutes / 60);\n      const minutes = durationMinutes % 60;\n      workDuration = `${hours}å°æ™‚${minutes}åˆ†é˜`;\n    }\n  }\n\n  return {\n    ...stat,\n    workDuration: workDuration\n  };\n});\n\n// æ’åº\nfinalResults.sort((a, b) => {\n  const dateCompare = b.date.localeCompare(a.date);\n  if (dateCompare !== 0) return dateCompare;\n  return a.userName.localeCompare(b.userName, 'zh-TW');\n});\n\n// çµ±è¨ˆæ‘˜è¦\nconst summary = {\n  totalRecords: finalResults.length,\n  uniqueUsers: [...new Set(finalResults.map(r => r.userName))].length,\n  dateRange: {\n    from: finalResults.length > 0 ? finalResults[finalResults.length - 1].date : '',\n    to: finalResults.length > 0 ? finalResults[0].date : ''\n  },\n  statusBreakdown: {}\n};\n\nfinalResults.forEach(record => {\n  const status = record.status;\n  summary.statusBreakdown[status] = (summary.statusBreakdown[status] || 0) + 1;\n});\n\nconsole.log(\"=== è™•ç†å®Œæˆ ===\");\nconsole.log(\"ç¸½è¨˜éŒ„æ•¸ï¼š\", finalResults.length);\nconsole.log(\"ç‹€æ…‹çµ±è¨ˆï¼š\", summary.statusBreakdown);\nconsole.log(\"è‡ªå‹•è­˜åˆ¥çš„ä½¿ç”¨è€…æ•¸:\", Object.keys(autoUserMapping).length);\n\nreturn {\n  summary: summary,\n  records: finalResults,\n  rawDataCount: attendanceData.length\n};\n"
      },
      "id": "9da538dc-117c-4a85-8944-2080140a2063",
      "name": "è§£æå‡ºç¼ºå‹¤è³‡æ–™",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -352,
        352
      ]
    },
    {
      "parameters": {
        "jsCode": "// å–å¾—è¼¸å…¥è³‡æ–™\nconst inputData = $input.first().json;\nconst records = inputData.records || [];\n\n// å–å¾—ä»Šå¤©æ—¥æœŸï¼ˆå°åŒ—æ™‚å€ï¼‰\nconst today = new Date();\nconst todayStr = today.toLocaleDateString('zh-TW', {\n  timeZone: 'Asia/Taipei',\n  year: 'numeric',\n  month: '2-digit',\n  day: '2-digit'\n});\n\nconsole.log(\"ä»Šå¤©æ—¥æœŸ:\", todayStr);\nconsole.log(\"ç¸½è¨˜éŒ„æ•¸:\", records.length);\n\n// éæ¿¾ä»Šå¤©çš„è«‹å‡è¨˜éŒ„\nconst todayLeaves = records.filter(record => {\n  if (!record) return false;\n  \n  // æª¢æŸ¥æ—¥æœŸ\n  let recordDate = record.date;\n  if (!recordDate) return false;\n  \n  // æ¨™æº–åŒ–æ—¥æœŸæ ¼å¼\n  if (typeof recordDate === 'string') {\n    recordDate = recordDate.trim();\n    if (recordDate.includes('-')) {\n      recordDate = recordDate.replace(/-/g, '/');\n    }\n  }\n  \n  // æ¯”å°æ—¥æœŸ\n  const matchesDate = recordDate === todayStr;\n  \n  // æª¢æŸ¥æ˜¯å¦ç‚ºè«‹å‡ï¼ˆä¸æ˜¯æ­£å¸¸ä¸Šç­ï¼‰\n  const isLeave = record.status && \n                  record.status !== 'æ­£å¸¸ä¸Šç­' && \n                  record.status !== '';\n  \n  return matchesDate && isLeave;\n});\n\nconsole.log(\"ä»Šæ—¥è«‹å‡äººæ•¸:\", todayLeaves.length);\n\n// å»ºç«‹è¼¸å‡ºè³‡æ–™\nlet sheetData = todayLeaves.map(record => ({\n  date: record.date || todayStr,\n  userName: record.userName || 'æœªçŸ¥',\n  status: record.status || 'æœªçŸ¥ç‹€æ…‹',\n  checkInTime: record.firstCheckIn || record.checkInTime || '-',\n  checkOutTime: record.lastCheckOut || record.checkOutTime || '-',\n  details: record.details || 'ç„¡è©³ç´°è³‡è¨Š'\n}));\n\n// å¦‚æœæ²’æœ‰è«‹å‡è¨˜éŒ„ï¼ŒåŠ å…¥é è¨­è¨Šæ¯\nif (sheetData.length === 0) {\n  console.log(\"ä»Šæ—¥ç„¡äººè«‹å‡\");\n  sheetData = [{\n    date: todayStr,\n    userName: 'ç„¡',\n    status: 'å…¨å“¡æ­£å¸¸ä¸Šç­',\n    checkInTime: '-',\n    checkOutTime: '-',\n    details: 'ä»Šæ—¥ç„¡äººè«‹å‡'\n  }];\n}\n\nreturn sheetData;"
      },
      "id": "cd19094c-0182-4fc6-a5b6-04e2c1fb5e59",
      "name": "ä»Šæ—¥è«‹å‡è³‡æ–™",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -176,
        -144
      ]
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// é ç·¨è­¯çš„æ­£å‰‡è¡¨é”å¼å¸¸æ•¸\n// ========================================\nconst LEAVE_PATTERNS = {\n  // æ¨¡å¼ 1: \"14-\", \"14:00-\", \"11:44~\" ç­‰ (å¾æŸæ™‚é–“åˆ°ä¸‹ç­)\n  partialToEnd: /(\\d{1,2}):?(\\d{2})?[\\s]*[\\-~][\\s]*(?=\\s|@|$|ç‰¹ä¼‘|ç—…å‡|äº‹å‡|å¹´å‡|å‡ºå·®|é ç«¯)/,\n  // æ¨¡å¼ 2: \"14:00-18:00\" æˆ– \"14:00~18:00\" (æ˜ç¢ºçš„æ™‚é–“ç¯„åœ)\n  timeRange: /(\\d{1,2}):(\\d{2})[\\s]*[\\-~][\\s]*(\\d{1,2}):(\\d{2})/\n};\n\n// ä½¿ç”¨è€…åç¨±é©—è­‰æ­£å‰‡è¡¨é”å¼\nconst VALID_USER_PATTERNS = [\n  /^[a-zA-Z]+\\.[a-zA-Z]+$/,           // è‹±æ–‡å.å§“æ°ç¸®å¯« (å¦‚ ryan.l)\n  /^[a-zA-Z]+_[a-zA-Z]+$/,            // è‹±æ–‡å_å§“æ°\n  /^[a-zA-Z]+\\-[a-zA-Z]+$/,           // éƒ¨é–€-åå­—æ ¼å¼ (å¦‚ RD-Alan)\n  /^[a-zA-Z][a-zA-Z0-9._\\-]{1,30}$/,  // ä¸€èˆ¬è‹±æ–‡ä½¿ç”¨è€…åç¨±\n  /^[\\u4e00-\\u9fa5]{2,5}$/,           // ä¸­æ–‡åå­—ï¼ˆ2-5å€‹å­—ï¼‰\n  /^[A-Za-z]+[-\\s][\\u4e00-\\u9fa5\\w\\s]+$/, // éƒ¨é–€-ä¸­è‹±æ–‡æ··åˆ (å¦‚ Math-Mike Tsai)\n  /^U[A-Z0-9]{10,12}$/                // Slack User ID æ ¼å¼\n];\n\nconst INVALID_USER_PATTERNS = [\n  /^\\d+\\/\\d+$/,                    // æ—¥æœŸæ ¼å¼ (å¦‚ \"1/16\")\n  /^\\d{3,4}[~\\-]\\d{3,4}$/,         // æ™‚é–“ç¯„åœ (å¦‚ \"1730~1800\")\n  /^\\d+\\./,                        // æ•¸å­—é–‹é ­åŠ å¥é» (å¦‚ \"15.\")\n  /è…¸èƒƒç‚|ç—…å‡|ç‰¹ä¼‘|å¹´å‡|å‡ºå·®/,      // è«‹å‡é¡å‹é—œéµå­—\n  /ä¹‹å¾Œæ”¹|å¾…ç¢ºèª|æš«å®š/               // å‚™è¨»æ–‡å­—\n];\n\n// è«‹å‡é¡å‹å°æ‡‰è¡¨ (ä½¿ç”¨ Map å–ä»£ switch-case)\nconst LEAVE_TYPE_MAP = new Map([\n  ['ç—…å‡', 'sickLeave'],\n  ['ç”Ÿç—…', 'sickLeave'],\n  ['çœ‹è¨º', 'sickLeave'],\n  ['å°±é†«', 'sickLeave'],\n  ['ç‰¹ä¼‘', 'annualLeave'],\n  ['å¹´å‡', 'annualLeave'],\n  ['ä¼‘å‡', 'annualLeave'],\n  ['å‡ºå·®', 'businessTrip'],\n  ['å…¬å‡º', 'businessTrip'],\n  ['å¤–å‡º', 'businessTrip'],\n  ['å‡ºå…¬å·®', 'businessTrip'],\n  ['é ç«¯å·¥ä½œ', 'remote'],\n  ['åœ¨å®¶å·¥ä½œ', 'remote'],\n  ['remote', 'remote'],\n  ['WFH', 'remote'],\n  ['å±…å®¶è¾¦å…¬', 'remote'],\n  ['äº‹å‡', 'personalLeave'],\n  ['ç§äº‹', 'personalLeave'],\n  ['å€‹äººäº‹å‡', 'personalLeave'],\n  ['å©šå‡', 'marriageLeave'],\n  ['çµå©š', 'marriageLeave'],\n  ['å–ªå‡', 'bereavementLeave'],\n  ['å¥”å–ª', 'bereavementLeave'],\n  ['ç”¢å‡', 'maternityLeave'],\n  ['é™ªç”¢å‡', 'maternityLeave'],\n  ['è‚²å¬°å‡', 'maternityLeave'],\n  ['ç”¢æª¢å‡', 'maternityLeave'],\n  ['ç”Ÿç†å‡', 'menstrualLeave'],\n  ['ç”Ÿç†', 'menstrualLeave'],\n  ['ç¶“æœŸ', 'menstrualLeave'],\n  ['MC', 'menstrualLeave'],\n  ['è£œä¼‘', 'compensatoryLeave'],\n  ['è£œå‡', 'compensatoryLeave'],\n  ['èª¿ä¼‘', 'compensatoryLeave'],\n  ['å…¬å‡', 'officialLeave'],\n  ['æŠ•ç¥¨', 'officialLeave'],\n  ['å…µå½¹', 'officialLeave'],\n  ['å…¬å‹™', 'officialLeave'],\n  ['ç”Ÿæ—¥å‡', 'birthdayLeave'],\n  ['ç”Ÿæ—¥', 'birthdayLeave'],\n  ['Birthday', 'birthdayLeave'],\n  ['BD', 'birthdayLeave']\n]);\n\n// æ¬„ä½åç¨±æ˜ å°„\nconst LEAVE_FIELD_MAP = {\n  sickLeave: { days: 'sickLeave', hours: 'sickLeaveHours' },\n  annualLeave: { days: 'annualLeave', hours: 'annualLeaveHours' },\n  businessTrip: { days: 'businessTrip', hours: 'businessTripHours' },\n  remote: { days: 'remote', hours: 'remoteHours' },\n  personalLeave: { days: 'personalLeave', hours: 'personalLeaveHours' },\n  marriageLeave: { days: 'marriageLeave', hours: 'marriageLeaveHours' },\n  bereavementLeave: { days: 'bereavementLeave', hours: 'bereavementLeaveHours' },\n  maternityLeave: { days: 'maternityLeave', hours: 'maternityLeaveHours' },\n  menstrualLeave: { days: 'menstrualLeave', hours: 'menstrualLeaveHours' },\n  compensatoryLeave: { days: 'compensatoryLeave', hours: 'compensatoryLeaveHours' },\n  officialLeave: { days: 'officialLeave', hours: 'officialLeaveHours' },\n  birthdayLeave: { days: 'birthdayLeave', hours: 'birthdayLeaveHours' },\n  others: { days: 'others', hours: 'othersHours' }\n};\n\n// ========================================\n// è¨ˆç®—è«‹å‡æ™‚æ•¸å‡½æ•¸\n// ========================================\nfunction calculateLeaveHours(detailsText) {\n  if (!detailsText) {\n    return { hours: 8, days: 1, type: 'full-day' };\n  }\n\n  const text = detailsText.toLowerCase();\n\n  // æ¨¡å¼ 1: \"14-\", \"14:00-\", \"11:44~\" ç­‰ (å¾æŸæ™‚é–“åˆ°ä¸‹ç­)\n  const match1 = text.match(LEAVE_PATTERNS.partialToEnd);\n  if (match1) {\n    const startHour = parseInt(match1[1]);\n    const startMin = match1[2] ? parseInt(match1[2]) : 0;\n    const endHour = 18; // å‡è¨­ä¸‹ç­æ™‚é–“ 18:00\n    const endMin = 0;\n    const totalMinutes = (endHour * 60 + endMin) - (startHour * 60 + startMin);\n    const hours = Math.max(0, totalMinutes / 60);\n    return {\n      hours: hours,\n      days: hours / 8,\n      type: 'partial',\n      description: startHour + ':' + startMin.toString().padStart(2, '0') + 'åˆ°ä¸‹ç­ï¼ˆ' + hours.toFixed(1) + 'å°æ™‚ï¼‰'\n    };\n  }\n\n  // æ¨¡å¼ 2: \"14:00-18:00\" æˆ– \"14:00~18:00\" (æ˜ç¢ºçš„æ™‚é–“ç¯„åœ)\n  const match2 = text.match(LEAVE_PATTERNS.timeRange);\n  if (match2) {\n    const startHour = parseInt(match2[1]);\n    const startMin = parseInt(match2[2]);\n    const endHour = parseInt(match2[3]);\n    const endMin = parseInt(match2[4]);\n    const totalMinutes = (endHour * 60 + endMin) - (startHour * 60 + startMin);\n    const hours = totalMinutes / 60;\n    return {\n      hours: hours,\n      days: hours / 8,\n      type: 'partial',\n      description: hours.toFixed(1) + 'å°æ™‚'\n    };\n  }\n\n  // æ¨¡å¼ 3: \"ä¸Šåˆ\" (09:00-12:00 = 3å°æ™‚)\n  if (text.includes('ä¸Šåˆ')) {\n    return { hours: 3, days: 3/8, type: 'morning', description: 'ä¸Šåˆï¼ˆ3å°æ™‚ï¼‰' };\n  }\n\n  // æ¨¡å¼ 4: \"ä¸‹åˆ\" (14:00-18:00 = 4å°æ™‚)\n  if (text.includes('ä¸‹åˆ')) {\n    return { hours: 4, days: 4/8, type: 'afternoon', description: 'ä¸‹åˆï¼ˆ4å°æ™‚ï¼‰' };\n  }\n\n  // æ¨¡å¼ 5: \"åŠå¤©\"\n  if (text.includes('åŠå¤©')) {\n    return { hours: 4, days: 4/8, type: 'half-day', description: 'åŠå¤©ï¼ˆ4å°æ™‚ï¼‰' };\n  }\n\n  // é è¨­ï¼šå…¨å¤© 8 å°æ™‚\n  return { hours: 8, days: 1, type: 'full-day', description: 'å…¨å¤©ï¼ˆ8å°æ™‚ï¼‰' };\n}\n\n// ========================================\n// é©—è­‰ä½¿ç”¨è€…åç¨±å‡½æ•¸ï¼ˆå„ªåŒ–ç‰ˆï¼‰\n// ========================================\nfunction isValidUserName(name) {\n  if (!name || typeof name !== 'string') return false;\n\n  const trimmedName = name.trim();\n\n  // æ’é™¤ Unknown\n  if (trimmedName.toLowerCase() === 'unknown') return false;\n\n  // æ’é™¤æ˜é¡¯ä¸æ˜¯ä½¿ç”¨è€…åç¨±çš„å…§å®¹\n  if (INVALID_USER_PATTERNS.some(pattern => pattern.test(trimmedName))) {\n    return false;\n  }\n\n  // æ­£å‘é©—è­‰ï¼šæª¢æŸ¥æ˜¯å¦ç¬¦åˆæœ‰æ•ˆçš„ä½¿ç”¨è€…åç¨±æ ¼å¼\n  return VALID_USER_PATTERNS.some(pattern => pattern.test(trimmedName));\n}\n\nconst data = $input.first().json;\nconst year2025Records = data.records.filter(record => {\n  return record.date && record.date.startsWith('2025');\n});\n\nconst leaveStats = {};\nconst invalidRecords = [];\nconst unknownStatuses = new Set(); // æ”¶é›†æœªåˆ†é¡çš„ç‹€æ…‹\nlet unknownCount = 0; // è¨ˆç®—è¢«æ’é™¤çš„ Unknown è¨˜éŒ„æ•¸\n\nyear2025Records.forEach(record => {\n  // å…ˆæª¢æŸ¥æ˜¯å¦ç‚º Unknown\n  if (record.userName && record.userName.toLowerCase() === 'unknown') {\n    unknownCount++;\n    return; // ç›´æ¥è·³é Unknown è¨˜éŒ„\n  }\n\n  // ä½¿ç”¨ userName æ¬„ä½ï¼Œä½†è¦å…ˆé©—è­‰\n  if (!isValidUserName(record.userName)) {\n    invalidRecords.push({\n      date: record.date,\n      userName: record.userName,\n      status: record.status,\n      details: record.details,\n      issue: 'ç„¡æ•ˆçš„ä½¿ç”¨è€…åç¨±'\n    });\n    return;\n  }\n\n  if (record.status && record.status !== 'æ­£å¸¸ä¸Šç­') {\n    const userName = record.userName;\n\n    if (!leaveStats[userName]) {\n      leaveStats[userName] = {\n        userName: userName,\n        totalDays: 0,\n        totalHours: 0,\n        sickLeave: 0,\n        sickLeaveHours: 0,\n        annualLeave: 0,\n        annualLeaveHours: 0,\n        businessTrip: 0,\n        businessTripHours: 0,\n        remote: 0,\n        remoteHours: 0,\n        personalLeave: 0,\n        personalLeaveHours: 0,\n        marriageLeave: 0,\n        marriageLeaveHours: 0,\n        bereavementLeave: 0,\n        bereavementLeaveHours: 0,\n        maternityLeave: 0,\n        maternityLeaveHours: 0,\n        menstrualLeave: 0,\n        menstrualLeaveHours: 0,\n        compensatoryLeave: 0,\n        compensatoryLeaveHours: 0,\n        officialLeave: 0,\n        officialLeaveHours: 0,\n        birthdayLeave: 0,\n        birthdayLeaveHours: 0,\n        others: 0,\n        othersHours: 0,\n        halfDayCount: 0\n      };\n    }\n\n    // ä½¿ç”¨æ–°çš„æ™‚æ•¸è¨ˆç®—å‡½æ•¸\n    const leaveInfo = calculateLeaveHours(record.details);\n    const daysToAdd = leaveInfo.days;\n    const hoursToAdd = leaveInfo.hours;\n    leaveStats[userName].totalDays += daysToAdd;\n    leaveStats[userName].totalHours += hoursToAdd;\n\n    if (leaveInfo.type === 'half-day' || leaveInfo.days < 1) {\n      leaveStats[userName].halfDayCount++;\n    }\n\n    // ä½¿ç”¨æŸ¥æ‰¾è¡¨å–ä»£ switch-case\n    const leaveType = LEAVE_TYPE_MAP.get(record.status);\n    if (leaveType && LEAVE_FIELD_MAP[leaveType]) {\n      const fields = LEAVE_FIELD_MAP[leaveType];\n      leaveStats[userName][fields.days] += daysToAdd;\n      leaveStats[userName][fields.hours] += hoursToAdd;\n    } else {\n      // æœªåˆ†é¡çš„ç‹€æ…‹\n      leaveStats[userName].others += daysToAdd;\n      leaveStats[userName].othersHours += hoursToAdd;\n      unknownStatuses.add(record.status);\n    }\n  }\n});\n\nconst ranking = Object.values(leaveStats)\n  .filter(stat => stat.userName.toLowerCase() !== 'unknown') // å…ˆéæ¿¾æ‰ Unknown\n  .sort((a, b) => b.totalDays - a.totalDays)\n  .map((stat, index) => ({\n    rank: index + 1,\n    userName: stat.userName,\n    totalDays: stat.totalDays,\n    totalHours: stat.totalHours,\n    sickLeave: stat.sickLeave,\n    sickLeaveHours: stat.sickLeaveHours,\n    annualLeave: stat.annualLeave,\n    annualLeaveHours: stat.annualLeaveHours,\n    businessTrip: stat.businessTrip,\n    businessTripHours: stat.businessTripHours,\n    remote: stat.remote,\n    remoteHours: stat.remoteHours,\n    personalLeave: stat.personalLeave,\n    personalLeaveHours: stat.personalLeaveHours,\n    marriageLeave: stat.marriageLeave,\n    marriageLeaveHours: stat.marriageLeaveHours,\n    bereavementLeave: stat.bereavementLeave,\n    bereavementLeaveHours: stat.bereavementLeaveHours,\n    maternityLeave: stat.maternityLeave,\n    maternityLeaveHours: stat.maternityLeaveHours,\n    menstrualLeave: stat.menstrualLeave,\n    menstrualLeaveHours: stat.menstrualLeaveHours,\n    compensatoryLeave: stat.compensatoryLeave,\n    compensatoryLeaveHours: stat.compensatoryLeaveHours,\n    officialLeave: stat.officialLeave,\n    officialLeaveHours: stat.officialLeaveHours,\n    birthdayLeave: stat.birthdayLeave,\n    birthdayLeaveHours: stat.birthdayLeaveHours,\n    others: stat.others,\n    othersHours: stat.othersHours,\n    halfDayCount: stat.halfDayCount\n  }));\n\n// è¨ºæ–·è³‡è¨Š\nconsole.log('=== 2025å¹´è«‹å‡çµ±è¨ˆå ±å‘Š ===');\nconsole.log(`\\nè™•ç†äº† ${year2025Records.length} ç­† 2025 å¹´è¨˜éŒ„`);\nconsole.log(`æ’é™¤äº† ${unknownCount} ç­† Unknown è¨˜éŒ„`);\nconsole.log(`çµ±è¨ˆäº† ${Object.keys(leaveStats).length} ä½å“¡å·¥çš„è«‹å‡è¨˜éŒ„`);\n\nif (invalidRecords.length > 0) {\n  console.log(`\\nâš ï¸ ç™¼ç¾ ${invalidRecords.length} ç­†ç„¡æ•ˆè¨˜éŒ„`);\n  const uniqueInvalidNames = [...new Set(invalidRecords.map(r => r.userName))];\n  console.log('ç„¡æ•ˆçš„ä½¿ç”¨è€…åç¨±ç¯„ä¾‹:', uniqueInvalidNames.slice(0, 5));\n}\n\nif (unknownStatuses.size > 0) {\n  console.log('\\nğŸ“ æœªåˆ†é¡çš„è«‹å‡ç‹€æ…‹:');\n  Array.from(unknownStatuses).forEach(status => {\n    console.log(`  - \"${status}\"`);\n  });\n}\n\n// é¡¯ç¤ºè«‹å‡çµ±è¨ˆæ‘˜è¦\nconsole.log('\\nğŸ“Š è«‹å‡é¡å‹çµ±è¨ˆæ‘˜è¦:');\nconst totalByType = {\n  sickLeave: 0,\n  annualLeave: 0,\n  businessTrip: 0,\n  remote: 0,\n  personalLeave: 0,\n  marriageLeave: 0,\n  bereavementLeave: 0,\n  maternityLeave: 0,\n  menstrualLeave: 0,\n  compensatoryLeave: 0,\n  officialLeave: 0,\n  birthdayLeave: 0,\n  others: 0\n};\n\nranking.forEach(r => {\n  totalByType.sickLeave += r.sickLeave;\n  totalByType.annualLeave += r.annualLeave;\n  totalByType.businessTrip += r.businessTrip;\n  totalByType.remote += r.remote;\n  totalByType.personalLeave += r.personalLeave;\n  totalByType.marriageLeave += r.marriageLeave;\n  totalByType.bereavementLeave += r.bereavementLeave;\n  totalByType.maternityLeave += r.maternityLeave;\n  totalByType.menstrualLeave += r.menstrualLeave;\n  totalByType.compensatoryLeave += r.compensatoryLeave;\n  totalByType.officialLeave += r.officialLeave;\n  totalByType.birthdayLeave += r.birthdayLeave;\n  totalByType.others += r.others;\n});\n\nconsole.log(`  ç—…å‡: ${totalByType.sickLeave} å¤©`);\nconsole.log(`  ç‰¹ä¼‘/å¹´å‡: ${totalByType.annualLeave} å¤©`);\nconsole.log(`  å‡ºå·®/å…¬å‡º: ${totalByType.businessTrip} å¤©`);\nconsole.log(`  é ç«¯å·¥ä½œ: ${totalByType.remote} å¤©`);\nconsole.log(`  äº‹å‡: ${totalByType.personalLeave} å¤©`);\nconsole.log(`  å©šå‡: ${totalByType.marriageLeave} å¤©`);\nconsole.log(`  å–ªå‡: ${totalByType.bereavementLeave} å¤©`);\nconsole.log(`  ç”¢å‡/é™ªç”¢å‡: ${totalByType.maternityLeave} å¤©`);\nconsole.log(`  ç”Ÿç†å‡: ${totalByType.menstrualLeave} å¤©`);\nconsole.log(`  è£œä¼‘: ${totalByType.compensatoryLeave} å¤©`);\nconsole.log(`  å…¬å‡: ${totalByType.officialLeave} å¤©`);\nconsole.log(`  ç”Ÿæ—¥å‡: ${totalByType.birthdayLeave} å¤©`);\nconsole.log(`  å…¶ä»–: ${totalByType.others} å¤©`);\n\n// é¡¯ç¤ºå‰10åè«‹å‡æœ€å¤šçš„å“¡å·¥\nconsole.log('\\nğŸ† è«‹å‡å¤©æ•¸æ’è¡Œæ¦œ Top 10:');\nranking.slice(0, 10).forEach(r => {\n  let details = [];\n  if (r.annualLeave > 0) details.push(`ç‰¹ä¼‘:${r.annualLeave}`);\n  if (r.sickLeave > 0) details.push(`ç—…å‡:${r.sickLeave}`);\n  if (r.remote > 0) details.push(`é ç«¯:${r.remote}`);\n  if (r.businessTrip > 0) details.push(`å‡ºå·®:${r.businessTrip}`);\n  if (r.personalLeave > 0) details.push(`äº‹å‡:${r.personalLeave}`);\n  if (r.menstrualLeave > 0) details.push(`ç”Ÿç†å‡:${r.menstrualLeave}`);\n  if (r.birthdayLeave > 0) details.push(`ç”Ÿæ—¥å‡:${r.birthdayLeave}`);\n  if (r.compensatoryLeave > 0) details.push(`è£œä¼‘:${r.compensatoryLeave}`);\n  if (r.marriageLeave > 0) details.push(`å©šå‡:${r.marriageLeave}`);\n  if (r.bereavementLeave > 0) details.push(`å–ªå‡:${r.bereavementLeave}`);\n  if (r.maternityLeave > 0) details.push(`ç”¢å‡:${r.maternityLeave}`);\n  if (r.officialLeave > 0) details.push(`å…¬å‡:${r.officialLeave}`);\n  if (r.others > 0) details.push(`å…¶ä»–:${r.others}`);\n  if (r.halfDayCount > 0) details.push(`å«${r.halfDayCount}æ¬¡åŠå¤©`);\n\n  console.log(`  ${r.rank}. ${r.userName}: ${r.totalDays}å¤© (${details.join(', ')})`);\n});\n\n// ç‰¹åˆ¥çµ±è¨ˆï¼šä½¿ç”¨ç”Ÿæ—¥å‡çš„å“¡å·¥\nconst birthdayLeaveUsers = ranking.filter(r => r.birthdayLeave > 0);\nif (birthdayLeaveUsers.length > 0) {\n  console.log('\\nğŸ‚ ä½¿ç”¨ç”Ÿæ—¥å‡çš„å“¡å·¥:');\n  birthdayLeaveUsers.forEach(user => {\n    console.log(`  - ${user.userName}: ${user.birthdayLeave} å¤©`);\n  });\n}\n\n// ç‰¹åˆ¥çµ±è¨ˆï¼šä½¿ç”¨ç”Ÿç†å‡çš„å“¡å·¥\nconst menstrualLeaveUsers = ranking.filter(r => r.menstrualLeave > 0);\nif (menstrualLeaveUsers.length > 0) {\n  console.log('\\nğŸ©º ä½¿ç”¨ç”Ÿç†å‡çš„å“¡å·¥:');\n  menstrualLeaveUsers.forEach(user => {\n    console.log(`  - ${user.userName}: ${user.menstrualLeave} å¤©`);\n  });\n}\n\nreturn ranking;\n"
      },
      "id": "a4856b9a-86cb-4f0b-b41b-f183518fd023",
      "name": "2025å¹´æ’è¡Œæ¦œ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -112,
        352
      ]
    },
    {
      "parameters": {
        "resource": "channel",
        "operation": "history",
        "channelId": {
          "__rl": true,
          "value": "C05FXLH7BCJ",
          "mode": "list",
          "cachedResultName": "jvdæ¯æ—¥å‡ºå‹¤å›å ±"
        },
        "returnAll": true,
        "filters": {}
      },
      "id": "ceba5f32-4e34-4e8e-8af1-a58268533e63",
      "name": "å–å¾—é »é“è³‡è¨Š",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.1,
      "position": [
        -560,
        352
      ],
      "webhookId": "b6c1ebff-0cc6-4bfd-85d3-d0f73abed2f9",
      "alwaysOutputData": false,
      "credentials": {
        "slackApi": {
          "id": "UfdPURfRn78d2HjH",
          "name": "n8n-ops"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw",
          "mode": "list",
          "cachedResultName": "å‡ºå‹¤çµ±è¨ˆ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 205325504,
          "mode": "list",
          "cachedResultName": "2025æ’è¡Œæ¦œ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit#gid=205325504"
        },
        "clear": "specificRows",
        "startIndex": 2,
        "rowsToDelete": 300
      },
      "id": "4a3c6a39-321a-4aa7-8e57-fc9cdb5f2a43",
      "name": "æ¸…ç©º2025å¹´æ’è¡Œæ¦œ",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        -624,
        32
      ],
      "executeOnce": false,
      "credentials": {
        "googleApi": {
          "id": "u1JNoGs9f7NtuqBD",
          "name": "n8n-googlesheet"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw",
          "mode": "list",
          "cachedResultName": "å‡ºå‹¤çµ±è¨ˆ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 205325504,
          "mode": "list",
          "cachedResultName": "2025æ’è¡Œæ¦œ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit#gid=205325504"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "rank": "={{ $json.rank }}",
            "userName": "={{ $json.userName }}",
            "totalDays": "={{ $json.totalDays }}",
            "sickLeave": "={{ $json.sickLeave }}",
            "annualLeave": "={{ $json.annualLeave }}",
            "businessTrip": "={{ $json.businessTrip }}",
            "remote": "={{ $json.remote }}",
            "personalLeave": "={{ $json.personalLeave }}",
            "birthdayLeave": "={{ $json.birthdayLeave }}",
            "marriageLeave": "={{ $json.marriageLeave }}",
            "bereavementLeave": "={{ $json.bereavementLeave }}",
            "maternityLeave": "={{ $json.maternityLeave }}",
            "compensatoryLeave": "={{ $json.compensatoryLeave }}",
            "officialLeave": "={{ $json.officialLeave }}",
            "others": "={{ $json.others }}",
            "halfDayCount": "={{ $json.halfDayCount }}",
            "menstrualLeave": "={{ $json.menstrualLeave }}",
            "totalHours": "={{ $json.totalHours }}",
            "sickLeaveHours": "={{ $json.sickLeaveHours }}",
            "annualLeaveHours": "={{ $json.annualLeaveHours }}",
            "remoteHours": "={{ $json.remoteHours }}",
            "birthdayLeaveHours": "={{ $json.birthdayLeaveHours }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "rank",
              "displayName": "rank",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "userName",
              "displayName": "userName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "totalDays",
              "displayName": "totalDays",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "sickLeave",
              "displayName": "sickLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "annualLeave",
              "displayName": "annualLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "businessTrip",
              "displayName": "businessTrip",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "remote",
              "displayName": "remote",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "personalLeave",
              "displayName": "personalLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "birthdayLeave",
              "displayName": "birthdayLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "marriageLeave",
              "displayName": "marriageLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "bereavementLeave",
              "displayName": "bereavementLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "maternityLeave",
              "displayName": "maternityLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "menstrualLeave",
              "displayName": "menstrualLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "compensatoryLeave",
              "displayName": "compensatoryLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "officialLeave",
              "displayName": "officialLeave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "others",
              "displayName": "others",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "halfDayCount",
              "displayName": "halfDayCount",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "52d3977a-8357-4164-888f-3acd5aac605b",
      "name": "æ›´æ–°2025å¹´æ’è¡Œæ¦œ",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        112,
        352
      ],
      "alwaysOutputData": false,
      "credentials": {
        "googleApi": {
          "id": "u1JNoGs9f7NtuqBD",
          "name": "n8n-googlesheet"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw",
          "mode": "list",
          "cachedResultName": "å‡ºå‹¤çµ±è¨ˆ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "ä»Šæ—¥è«‹å‡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit#gid=0"
        },
        "clear": "specificRows",
        "startIndex": 2,
        "rowsToDelete": 65535
      },
      "id": "b940c649-5fdc-4117-8c62-ca9294be6bfe",
      "name": "æ¸…ç©ºä»Šæ—¥è«‹å‡",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        -800,
        32
      ],
      "credentials": {
        "googleApi": {
          "id": "u1JNoGs9f7NtuqBD",
          "name": "n8n-googlesheet"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw",
          "mode": "list",
          "cachedResultName": "å‡ºå‹¤çµ±è¨ˆ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "ä»Šæ—¥è«‹å‡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "date": "={{ $json.date }}",
            "userName": "={{ $json.userName }}",
            "status": "={{ $json.status }}",
            "checkInTime": "={{ $json.checkInTime }}",
            "checkOutTime": "={{ $json.checkOutTime }}",
            "details": "={{ $json.details }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "userName",
              "displayName": "userName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "checkInTime",
              "displayName": "checkInTime",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "checkOutTime",
              "displayName": "checkOutTime",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "details",
              "displayName": "details",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "workDuration",
              "displayName": "workDuration",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "bea34d1f-b6fd-4bbc-bbf0-a3f052b62151",
      "name": "æ›´æ–°ä»Šæ—¥è«‹å‡",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        16,
        48
      ],
      "credentials": {
        "googleApi": {
          "id": "u1JNoGs9f7NtuqBD",
          "name": "n8n-googlesheet"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// è™•ç†è«‹å‡è³‡æ–™ä¸¦æº–å‚™ Slack è¨Šæ¯\nconst CHANNEL_NAME = \"opsæ¯æ—¥å‡ºå‹¤å›å ±\";\nconst SHEET_URL = \"https://docs.google.com/spreadsheets/d/176_Vy1vjv-_-At94RmPp6mAT9TwMjme3QF7_UPo-fDw/edit?gid=0#gid=0\";\n\n// å–å¾—è¼¸å…¥è³‡æ–™\nconst inputItems = $input.all();\n\n// å¾ workflow static data å–å¾—ç‹€æ…‹è³‡è¨Š\nconst staticData = $getWorkflowStaticData('global');\nconst shouldSendNewMessage = staticData.shouldSendNewMessage || false;\nconst messageTs = staticData.messageTs || null;\nconst previousHash = staticData.lastHash || null;\n\n// å–å¾—ä»Šå¤©æ—¥æœŸï¼ˆå°åŒ—æ™‚å€ï¼‰\nconst now = new Date();\nconst currentDate = now.toLocaleDateString('zh-TW', {\n  timeZone: 'Asia/Taipei',\n  year: 'numeric',\n  month: '2-digit',\n  day: '2-digit'\n});\n\nconst month = now.getMonth() + 1;\nconst day = now.getDate();\nconst shortDate = `${month}/${day}`;\n\nconst currentTime = now.toLocaleTimeString('zh-TW', {\n  timeZone: 'Asia/Taipei',\n  hour: '2-digit',\n  minute: '2-digit',\n  hour12: false\n});\n\n// ç¯©é¸ä»Šæ—¥çš„è«‹å‡è¨˜éŒ„\nconst todayLeaves = [];\nfor (const item of inputItems) {\n  const record = item.json || item;\n  if (record.date === currentDate &&\n      record.status &&\n      record.status !== 'æ­£å¸¸ä¸Šç­' &&\n      record.userName &&\n      record.userName.toLowerCase() !== 'unknown' &&\n      record.userName !== 'ç„¡') {\n    todayLeaves.push(record);\n  }\n}\n\n// è¨ˆç®—å‡ºå‹¤è³‡æ–™çš„ hash å€¼\nfunction calculateAttendanceHash(records) {\n  if (!records || records.length === 0) return 'EMPTY';\n  const sorted = records.map(r => `${r.userName}:${r.status}`).sort().join('|');\n  return sorted;\n}\n\nconst attendanceHash = calculateAttendanceHash(todayLeaves);\n\n// æŒ‰ç‹€æ…‹åˆ†çµ„\nconst statusGroups = {};\ntodayLeaves.forEach(record => {\n  const status = record.status;\n  if (!statusGroups[status]) {\n    statusGroups[status] = [];\n  }\n  statusGroups[status].push(record.userName);\n});\n\n// å»ºç«‹ Slack è¨Šæ¯\nlet slackText = '';\n\nif (todayLeaves.length === 0) {\n  slackText = `ğŸ“… *${shortDate} å‡ºå‹¤ç‹€æ³*\\nâœ… ä»Šæ—¥ç„¡äººè«‹å‡`;\n} else {\n  slackText = `ğŸ“… *${shortDate} å‡ºå‹¤ç‹€æ³*\\nğŸ‘¥ å…± ${todayLeaves.length} äººè«‹å‡/é ç«¯\\n\\n`;\n\n  const statusEmojis = {\n    'é ç«¯å·¥ä½œ': 'ğŸ’»',\n    'åœ¨å®¶å·¥ä½œ': 'ğŸ ',\n    'ç—…å‡': 'ğŸ¥',\n    'äº‹å‡': 'ğŸ“',\n    'ç‰¹ä¼‘': 'ğŸ–ï¸',\n    'å¹´å‡': 'âœˆï¸',\n    'ç”Ÿæ—¥å‡': 'ğŸ‚',\n    'å‡ºå·®': 'ğŸš—',\n    'å…¬å‡º': 'ğŸ¢'\n  };\n\n  for (const [status, names] of Object.entries(statusGroups)) {\n    const emoji = statusEmojis[status] || 'ğŸ“Œ';\n    slackText += `${emoji} *${status}*\\n`;\n    names.forEach(name => {\n      slackText += `â€¢ ${name}\\n`;\n    });\n    slackText += '\\n';\n  }\n}\n\nslackText += `\\n_æœ€å¾Œæ›´æ–°: ${currentTime}_\\n`;\nslackText += `<${SHEET_URL}|ğŸ“Š æŸ¥çœ‹å®Œæ•´çµ±è¨ˆ>`;\nslackText += `\\n\\n<!-- hash:${attendanceHash} -->`;\n\nreturn [{\n  text: slackText,\n  channel: CHANNEL_NAME,\n  attendanceHash: attendanceHash,\n  previousHash: previousHash,\n  shouldSendNewMessage: shouldSendNewMessage,\n  messageTs: messageTs,\n  metadata: {\n    date: currentDate,\n    shortDate: shortDate,\n    totalCount: todayLeaves.length,\n    records: todayLeaves,\n    sheetUrl: SHEET_URL,\n    updateTime: currentTime\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        -144
      ],
      "id": "dd2a2f2b-9c43-4059-9e07-6d9a30d13ece",
      "name": "è™•ç†è«‹å‡è³‡æ–™",
      "executeOnce": false,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "change_detection_or_new_message",
              "leftValue": "={{ $json.shouldSendNewMessage }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            },
            {
              "id": "hash_changed",
              "leftValue": "={{ $json.attendanceHash }}",
              "rightValue": "={{ $json.previousHash }}",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        400,
        -144
      ],
      "id": "2ffcddce-b5d1-4065-9911-7914ace3306d",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "// å¾å‰ä¸€å€‹ç¯€é»ç²å–è³‡æ–™\nconst items = $input.all();\n\n// è®€å–ä¸Šæ¬¡çš„å‡ºå‹¤ hashï¼ˆå¾ Slack è¨Šæ¯çš„æœ€å¾Œä¸€è¡Œï¼‰\nlet previousHash = null;\nif (items.length > 0) {\n  const messages = items;\n  if (messages.length > 0) {\n    const lastMessage = messages[0].json;\n    const text = lastMessage.text || '';\n    \n    // å¾è¨Šæ¯ä¸­æå– hash (æ ¼å¼: <!-- hash:xxxxx -->)\n    const hashMatch = text.match(/<!-- hash:(.+?) -->/);\n    if (hashMatch) {\n      previousHash = hashMatch[1];\n    }\n  }\n}\n// æª¢æŸ¥æ˜¯å¦éœ€è¦ç™¼é€æ–°è¨Šæ¯æˆ–æ›´æ–°ç¾æœ‰è¨Šæ¯\nconst now = new Date();\nconst taipeiTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Taipei' }));\nconst currentHour = taipeiTime.getHours();\nconst currentDate = taipeiTime.toDateString();\n\n// å¾ Static Data å–å¾—ä¸Šæ¬¡çš„ timestamp å’Œæ—¥æœŸ\nconst staticData = $getWorkflowStaticData('global');\nlet messageTs = staticData.messageTs || null;\nlet lastDate = staticData.lastDate || null;\n\nconsole.log('ç•¶å‰æ™‚é–“:', taipeiTime);\nconsole.log('ç•¶å‰å°æ™‚:', currentHour);\nconsole.log('å„²å­˜çš„ timestamp:', messageTs);\nconsole.log('ä¸Šæ¬¡æ—¥æœŸ:', lastDate);\nconsole.log('ç•¶å‰æ—¥æœŸ:', currentDate);\n\n// åˆ¤æ–·æ˜¯å¦éœ€è¦ç™¼é€æ–°è¨Šæ¯\n// æ¢ä»¶ï¼šæ—©ä¸Š8é» æˆ– æ–°çš„ä¸€å¤© æˆ– æ²’æœ‰ timestamp\nlet shouldSendNewMessage = false;\n\nif (!messageTs) {\n  console.log('æ²’æœ‰ timestampï¼Œéœ€è¦ç™¼é€æ–°è¨Šæ¯');\n  shouldSendNewMessage = true;\n} else if (lastDate !== currentDate && currentHour >= 8) {\n  console.log('æ–°çš„ä¸€å¤©ä¸”å·²é8é»ï¼Œéœ€è¦ç™¼é€æ–°è¨Šæ¯');\n  shouldSendNewMessage = true;\n  // æ¸…é™¤èˆŠçš„ timestamp\n  staticData.messageTs = null;\n  messageTs = null;\n} else if (currentHour === 8 && lastDate !== currentDate) {\n  console.log('æ—©ä¸Š8é»ä¸”æ˜¯æ–°çš„ä¸€å¤©ï¼Œéœ€è¦ç™¼é€æ–°è¨Šæ¯');\n  shouldSendNewMessage = true;\n  // æ¸…é™¤èˆŠçš„ timestamp\n  staticData.messageTs = null;\n  messageTs = null;\n}\n\n// æ›´æ–°æœ€å¾Œè™•ç†æ—¥æœŸ\nstaticData.lastDate = currentDate;\n\nreturn {\n  previousHash: previousHash,\n  shouldSendNewMessage,\n  messageTs,\n  currentDate,\n  currentHour,\n  taipeiTime: taipeiTime.toLocaleString('zh-TW', { timeZone: 'Asia/Taipei' })\n};"
      },
      "id": "e99ffca7-c1a7-4729-acd7-9773795f4ca6",
      "name": "æª¢æŸ¥è¨Šæ¯ç‹€æ…‹",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -768,
        352
      ]
    },
    {
      "parameters": {
        "select": "user",
        "user": {
          "__rl": true,
          "value": "U07F9203EP8",
          "mode": "list",
          "cachedResultName": "lonely.h"
        },
        "text": "={{ $('è™•ç†è«‹å‡è³‡æ–™').item.json.text }}",
        "otherOptions": {}
      },
      "id": "a60c8b7c-f354-4b98-b401-3b750d1bf2ad",
      "name": "lonely.h",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.1,
      "position": [
        640,
        -96
      ],
      "webhookId": "e6f7aa0e-46db-4d6d-8eba-16a722eea060",
      "credentials": {
        "slackApi": {
          "id": "UfdPURfRn78d2HjH",
          "name": "n8n-ops"
        }
      }
    }
  ],
  "connections": {
    "æ¯å°æ™‚åŸ·è¡Œ1": {
      "main": [
        [
          {
            "node": "æª¢æŸ¥è¨Šæ¯ç‹€æ…‹",
            "type": "main",
            "index": 0
          },
          {
            "node": "æ¸…ç©ºä»Šæ—¥è«‹å‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æå‡ºç¼ºå‹¤è³‡æ–™": {
      "main": [
        [
          {
            "node": "ä»Šæ—¥è«‹å‡è³‡æ–™",
            "type": "main",
            "index": 0
          },
          {
            "node": "2025å¹´æ’è¡Œæ¦œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä»Šæ—¥è«‹å‡è³‡æ–™": {
      "main": [
        [
          {
            "node": "æ›´æ–°ä»Šæ—¥è«‹å‡",
            "type": "main",
            "index": 0
          },
          {
            "node": "è™•ç†è«‹å‡è³‡æ–™",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2025å¹´æ’è¡Œæ¦œ": {
      "main": [
        [
          {
            "node": "æ›´æ–°2025å¹´æ’è¡Œæ¦œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å–å¾—é »é“è³‡è¨Š": {
      "main": [
        [
          {
            "node": "è§£æå‡ºç¼ºå‹¤è³‡æ–™",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¸…ç©ºä»Šæ—¥è«‹å‡": {
      "main": [
        [
          {
            "node": "æ¸…ç©º2025å¹´æ’è¡Œæ¦œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è™•ç†è«‹å‡è³‡æ–™": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "lonely.h",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æª¢æŸ¥è¨Šæ¯ç‹€æ…‹": {
      "main": [
        [
          {
            "node": "å–å¾—é »é“è³‡è¨Š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {},
  "staticData": null
}